# Discharge in channel

## Установка

1. Скачиваем репозиторий в локальную директорию
2. Качаем Miniconda [отсюда](https://conda.io/miniconda.html), версия python 2.7
3. Создаем виртуальное окружение `conda create -n ocean python=2.7`
4. Активируем окружение 
   - Windows: `activate ocean`
   - UNIX: `source activate ocean`
5. Устанавливаем необходимые зависимости 
   1. `conda install pip`
   2. `pip install numpy pandas matplotlib geopy netcdf4`
6. Устанавливаем GRADS для работы с файлами модели. Скачать можно с [SourceForge](https://sourceforge.net/projects/opengrads/), почитать про  пакет на [официальной странице](http://cola.gmu.edu/grads/)

## Использование

1. По умолчанию, скрипт принимает данные, которые находятся в папках. Вложенные папки игнорируются Далее подробнее про них
   - **CTD** пока не используется
   - **ladcp** – сюда помещаются файлы .lad прямых измерений LADCP. В папке должны находиться <u>только</u> файлы одного разреза.
   - **model** – здесь должны лежать файлы  компонент течений, рассчитанных по модели. Файлы должны называться uu.ctl и vv.ctl (к ним должны соответственно прилагаться файлы uu.dat и vv.dat). В .ctl файлах необходимо изменить параметр `TDEF`, по умолчанию он равен `00:00Z00JAN0000`, для корректной работы надо изменить например на `00:00Z01JAN2000` (будет автоматизировано). Скрипт автоматически рассчитает из них .nc файлы. **Осторожно:** бинарники много весят (около 1гб каждый), так что готовьте место на диске.
   - **relief** – файл рельефа должен лежать здесь. Используется только один файл рельефа. Рельеф должен быть в формате LAT, LON, DEPTH. *<u>Предупреждаю</u>*, что самая сложная для расчета часть скрипта – именно работа с файлом рельефа, так что чем он меньше – тем лучше. Для перевода данных модели (*hhq.ctl*) в нужный формат можно воспользоваться скриптом `grads-relief.py`. Для него необходима установка pygrads. В ближайшее время будет доделано
2. После того, как вы заботливо разложите файлы по папкам, необходимо будет залезть в файл `config.py`. В нем осуществляются все настройки. Они хорошо задокументированы в коде. Обращу ваше внимание на то, что если вы хотите использовать свои пути к файлам – пишите абсолютные пути.
3. Наконец запуск! В активированном окружении (см. выше) переходим в папку (`cd your\local\path`) и запускаем программу `python main.py`. В консоли будет отображаться прогресс расчетов. Результаты вычисления появятся в папке **out** вместе с графиками.